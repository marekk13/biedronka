# biedronka
> Automate your household budget tracking with the Biedronka Grocery Tracker. This Python script creates and updates Excel spreadsheet with Biedronka grocery data, seamlessly syncing between Google Drive and local files. Utilizing Excel formulas, it breaks down individual spending based on consumed items, simplifying expense sharing among household members

## Table of Contents
* [Prerequisites](#prerequisites)
* [Instalation](#instalation)
* [Description](#description)

## Prerequisites

Before using this script, ensure you have the following prerequisites:

1. **Biedronka App:** Install the Biedronka mobile app on your device. This script relies on PDF files generated by the Biedronka app as receipts.

2. **Google Drive Account:** You must have a Google Drive account. The script will interact with your Google Drive to access and process the uploaded PDF receipts.

3. **Google Drive Folder:** Create a folder in your Google Drive named "biedronka" (case-insensitive). 

4. **Uploading Biedronka Receipts:** To seamlessly upload Biedronka receipts, initiate the process directly from the Biedronka app while viewing a PDF receipt. Utilize the iOS Share Sheet, select Google Drive, and specify the "biedronka" folder as the destination. Ensure that the PDF files from the Biedronka app are uploaded to the designated "biedronka" folder, allowing the script to automatically process and update the Excel spreadsheet.


## Instalation
To get started with the program, follow the steps below. 

### Access to Google Drive API
#### Go to the Google Cloud Console:
- Visit the Google Cloud Console.
- Create a new project or select an existing one.
  
#### Enable the Google Drive API:
- In the Cloud Console, navigate to the "API & Services" > "Library" section.
- Search for "Google Drive API" and enable it for your project.
  
#### Create OAuth 2.0 Credentials:
- In the Cloud Console, navigate to "APIs & Services" > "Credentials."
- Click on "Create Credentials" and choose "OAuth client ID."
- Select the application type (e.g., Desktop App, Web Application).
- Fill in the necessary information, including the authorized redirect URIs.
- Click "Create" to generate the OAuth 2.0 client ID.
  
#### Download Credentials:
- After creating the credentials, you'll be able to download them as a JSON file. This file is your credentials.json.
- Save the downloaded file to a folder where biedronka.py is located.


### Download dependencies
Before running the program, make sure you have the required dependencies installed. You can install them using the following command:
```bash
pip install -r requirements.txt
```

### Tesseract OCR and Poppler
To use this project, ensure you have Tesseract OCR and Poppler installed on your machine. Follow the links below for instructions on downloading and configuring the required dependencies:

- [Poppler](https://poppler.freedesktop.org/)
- [Tesseract OCR](https://tesseract-ocr.github.io/tessdoc/Installation.html)

After installation, update the path to the Tesseract folder in `biedronka.py` on line 19:
```python
pytesseract.pytesseract.tesseract_cmd = r'C:\Program Files\Tesseract-OCR\tesseract'
```
And update the path to the Poppler binaries on line 147:
```python
def __init__(self, poppler_path: str = r"C:\Program Files\Release-23.08.0-0\poppler-23.08.0\Library\bin") -> None:
```

### Update Names in Excel Spreadsheet
Before running the script, ensure you update line 271 in the `biedronka.py` file with the real names of people splitting Biedronka expenses instead of placeholders. The line to be updated is:
```python
ws.append(['Nazwa', 'Cena', 'Name1', 'Name2'])
```

## Description
### Google Drive Integration:

- Connects to Google Drive using OAuth2 authentication.
- Downloads PDF files containing Biedronka grocery receipts from a specific folder on Google Drive.
- Compares the dates of downloaded files with the latest date already present in the Excel spreadsheet.

### PDF Processing:

- Uses the pdf2image and pytesseract libraries to extract text data from PDF files.
- Creates corresponding text (.txt) files for each downloaded PDF file, containing the extracted text.

### Data Parsing:

- Implements a `DataParser` class to extract structured data from the text content of the Biedronka receipts.
- Parses dates and item details from the text using regular expressions.
- Organizes the parsed data into a dictionary, grouping it by month and year.

### Excel Data Handling:

**Connects seamlessly with Excel:** Utilizing the openpyxl library, the project seamlessly integrates with Excel spreadsheets, allowing for efficient data handling and manipulation.

**Multi-Sheet Management:** Manages multiple sheets within the spreadsheet, each dedicated to a specific month, ensuring organized and structured data representation.

**Automatic Subtotal Calculation:** After marking expenses with `PRAWDA` (`TRUE`) in the respective columns, the spreadsheet intelligently calculates subtotals for each person, streamlining expense tracking.

**Equal Cost Splitting:** Handles scenarios where a single grocery item is shared between two persons, automatically inserting `PRAWDA` in both name columns and distributing the cost equally.

The script provides a comprehensive solution for automating the update of grocery shopping data in an Excel spreadsheet, enhancing efficiency and reducing manual data entry efforts. <br />
![biedronka_github](https://github.com/marekk13/biedronka/assets/109167046/91638358-3e06-4437-a7d9-05944585dbfa)
